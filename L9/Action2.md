## Action 2  
**请设计一个基于DNN模型的推荐系统：阐述两阶段的架构（召回、排序）以及每个阶段的DNN模型设计【DNN输入层（如何进行特征选择）；DNN隐藏层结构；DNN输出层】**  
1、应用场景假设：某旅行社网站对于用户旅游项目的推荐  
2、召回阶段架构：  
（1）DNN输入层：① 特征选取：I、用户基本信息数据（性别、年龄、职业、所在城市）；II、用户行为信息数据（用户搜索历史、用户浏览历史、用户购买历史）；III、项目季节信息数据（由于用户对于旅游项目的选择具有一定的季节性，故将每个旅游项目被浏览次数最多的三个月份作为输入特征）。② 特征处理：I、对于用户行为信息数据采用word2vec的方式进行embedding，并采用取加权平均的方法得到1024维的用户搜索向量、用户浏览向量及用户购买向量；II、对于用户基本信息数据及项目季节信息数据进行归一化处理；III、将上述处理完成的向量进行拼接形成DNN的输入向量。  
（2）DNN隐藏层：采用3层塔型结构，激活函数选取ReLU函数，将embedded vector 全连接到隐藏层，各隐藏层的神经元个数分别为1024、512、256。  
（3）DNN输出层：采用ANN选取最近邻的旅游项目作为排序阶段的样本。  
3、排序阶段架构：（采用DeepFM模型）  
（1）特征选取：I、旅游项目基本信息数据（旅游项目名称、地点、标签）；II、旅游项目与用户的交互数据（页面展示的旅游项目、用户点击的旅游项目、用户购买的旅游项目、用户购买某个标签旅游项目的次数）；  
（2）将上述选取的特征通过embedding层形成Dense Vector；  
（3）将Dense Vector同时传入到FM模型以及DNN模型中，此处的DNN模型结构采用与召回阶段相同的结构（即三层塔型结构），最终将输出进行累加得到最终推荐结果。

