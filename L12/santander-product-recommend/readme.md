## 项目小结  
**1、数据集：**  
Santander-product-recommend （经过处理的kaggle数据集，测试集约53万条数据）  
**2、预测模型：**  
Xgboost  
**3、项目时长：**  
约4周  
**4、项目流程：**  
① 数据探索&数据清洗：在对特征数据进行探索后发现部分特征存在数据缺失的情况，对于缺失值较少的特征，我直接用0或999作为替代进行补入；同时，对于用户特征数据全部缺失的行我直接予以了剔除；对于收入数据，我觉得收入对于新产品类型的购买存在较为显著的影响，故对于缺失值我没有直接采用平均值的方式进行补全，而是用Xgboost先行进行了一次预测，采用预测值作为补全数据。  
② 特征构造：在本次项目中我添加了2个新特征作为特征变量（a、use_time特征用以反映用户对于银行的忠诚度，越是老用户越有可能购买小众产品；b、month_label特征用以反应不同产品在不同月度的购买情况）。  
③ 目标列构造：由于在测试集中每一行给出的是用户当月的产品持有情况，而问题是需要预测用户未来会购买产品的情况；故我对目标数据进行了处理，当某个用户ID首次出现时，我认为该月其持有的产品为其新购买的产品；而后续每个月与上个月进行进行差分，当差分结果为1时表明该用户这个月购买了该产品，当差分结果为-1时表明该用户这个月出售了该产品，当差分结果为0时表明该用户该月未对产品进行操作；由此可以得到新的目标矩阵；在对目标矩阵进行聚合后得到用户新购买产品的标签。由于需要解决的问题是用户新购买不同产品的概率，即隐藏假定是用户一定会购买产品，故我在处理目标列时将不购买产品的行全部删去以减少训练的数据量级。  
④ 模型训练：采用Xgboost模型进行训练，并输出不同产品的购买概率矩阵，对每行选取概率最高的前七个产品进行输出，得到预测集数据。  
**5、项目中遇到的问题及解决方法**  
① 最初进行收入预测时，收入预测值中存在负值的情况，不符合日常逻辑；最终在收入预测前，将原数据集中位于均值3个标准差以外的异常值剔除，得到了较为正常的数据  
② 最初在Xgboost多分类预测时，我直接将产品的目标矩阵转化成array后作为label传入，得到结果第一个分类概率永远接近1；多次改动无果后，我对目标矩阵进行了转化，提取出每个产品的标签（以0-23记），如果用户在某个日期购买了某产品，则该行的label为该产品的标签，若购买多个产品，则分多行进行列示；经过此次改动后，Xgboost模型可以预测出较为正常的结果  
**6、项目中遇到的尚未解决的问题**  
① 在colab运行全量数据集时，每次数据载入都会发生会话崩溃，造成该现象的原因显示是内存不足，未来如果跑全量数据集，可能需要扩展colab的内存？  

